INFO:__main__:Command line arguments: main.py --gpu 0 --seed 0 --log_group simplenet_mvtec --log_project MVTecAD_Results --results_path results --run_name run net -b wideresnet50 -le layer2 -le layer3 --pretrain_embed_dimension 1536 --target_embed_dimension 1536 --patchsize 3 --meta_epochs 40 --embedding_size 256 --gan_epochs 4 --noise_std 0.015 --dsc_hidden 1024 --dsc_layers 2 --dsc_margin .5 --pre_proj 1 dataset --batch_size 4 --resize 329 --imagesize 288 -d screw -d pill -d capsule -d carpet -d grid -d tile -d wood -d zipper -d cable -d toothbrush -d transistor -d metal_nut -d bottle -d hazelnut -d leather mvtec /home/kan/proj/SimpleNet/data4/MVTec_ad
INFO:__main__:Dataset: train=320 test=160
INFO:__main__:Dataset: train=267 test=167
INFO:__main__:Dataset: train=219 test=132
INFO:__main__:Dataset: train=280 test=117
INFO:__main__:Dataset: train=264 test=78
INFO:__main__:Dataset: train=230 test=117
INFO:__main__:Dataset: train=247 test=79
INFO:__main__:Dataset: train=240 test=151
INFO:__main__:Dataset: train=224 test=150
INFO:__main__:Dataset: train=60 test=42
INFO:__main__:Dataset: train=213 test=100
INFO:__main__:Dataset: train=220 test=115
INFO:__main__:Dataset: train=209 test=83
INFO:__main__:Dataset: train=391 test=110
INFO:__main__:Dataset: train=245 test=124
INFO:__main__:Evaluating dataset [mvtec_screw] (1/15)...
/home/kan/anaconda3/envs/fed38/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/kan/anaconda3/envs/fed38/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=Wide_ResNet50_2_Weights.IMAGENET1K_V1`. You can also use `weights=Wide_ResNet50_2_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
INFO:__main__:Training models (1/1)
INFO:simplenet:Training discriminator...
epoch:3 loss:0.26047 lr:0.0002 p_true:0.64 p_fake:0.662: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:38<00:00,  9.74s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.11736 lr:0.0002 p_true:0.847 p_fake:0.856: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:39<00:00,  9.82s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.08015 lr:0.0002 p_true:0.894 p_fake:0.899: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:40<00:00, 10.08s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.04215 lr:0.0002 p_true:0.938 p_fake:0.94: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:40<00:00, 10.17s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.02159 lr:0.0002 p_true:0.963 p_fake:0.964: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:41<00:00, 10.44s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.04154 lr:0.0002 p_true:0.944 p_fake:0.948: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:39<00:00,  9.94s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.02331 lr:0.0002 p_true:0.966 p_fake:0.967: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:39<00:00,  9.96s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00659 lr:0.0002 p_true:0.986 p_fake:0.987: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:39<00:00,  9.95s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00033 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:39<00:00,  9.89s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00039 lr:0.0002 p_true:0.998 p_fake:0.998: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:39<00:00,  9.91s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00034 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:39<00:00,  9.96s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.09603 lr:0.0002 p_true:0.912 p_fake:0.914: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:41<00:00, 10.40s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00328 lr:0.0002 p_true:0.993 p_fake:0.993: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:39<00:00,  9.99s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00027 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:39<00:00,  9.91s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00011 lr:0.0002 p_true:1.0 p_fake:0.999: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:41<00:00, 10.35s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:9e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:41<00:00, 10.42s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.0002 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:41<00:00, 10.30s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.17479 lr:0.0002 p_true:0.865 p_fake:0.87: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:41<00:00, 10.41s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00448 lr:0.0002 p_true:0.992 p_fake:0.992: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:40<00:00, 10.16s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.0001 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:39<00:00,  9.86s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:8e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:39<00:00,  9.85s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:7e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:39<00:00,  9.90s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:7e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:39<00:00,  9.89s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00145 lr:0.0002 p_true:0.997 p_fake:0.997: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:39<00:00,  9.86s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.01798 lr:0.0002 p_true:0.978 p_fake:0.978: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:40<00:00, 10.06s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00012 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:39<00:00,  9.87s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:3e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:39<00:00,  9.86s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:3e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:39<00:00, 10.00s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:4e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:39<00:00,  9.81s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:4e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:39<00:00,  9.87s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.0186 lr:0.0002 p_true:0.982 p_fake:0.985: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:40<00:00, 10.08s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.01146 lr:0.0002 p_true:0.985 p_fake:0.986: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:41<00:00, 10.27s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:7e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:40<00:00, 10.16s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:3e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:39<00:00,  9.88s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:3e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:39<00:00,  9.81s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:3e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:39<00:00,  9.90s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00027 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:40<00:00, 10.12s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.03794 lr:0.0002 p_true:0.963 p_fake:0.962: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:40<00:00, 10.10s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00012 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:41<00:00, 10.29s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:2e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:40<00:00, 10.06s/it]
INFO:__main__:instance_auroc: 0.977                                                                                                                                                                          
INFO:__main__:full_pixel_auroc: 0.991
INFO:__main__:anomaly_pixel_auroc: 0.951
INFO:__main__:

-----

INFO:__main__:Evaluating dataset [mvtec_pill] (2/15)...
/home/kan/anaconda3/envs/fed38/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/kan/anaconda3/envs/fed38/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=Wide_ResNet50_2_Weights.IMAGENET1K_V1`. You can also use `weights=Wide_ResNet50_2_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
INFO:__main__:Training models (1/1)
INFO:simplenet:Training discriminator...
epoch:3 loss:0.2617 lr:0.0002 p_true:0.558 p_fake:0.579: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:33<00:00,  8.43s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.05278 lr:0.0002 p_true:0.872 p_fake:0.879: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:33<00:00,  8.46s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.01327 lr:0.0002 p_true:0.957 p_fake:0.959: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:33<00:00,  8.35s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00551 lr:0.0002 p_true:0.979 p_fake:0.98: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:34<00:00,  8.69s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00344 lr:0.0002 p_true:0.986 p_fake:0.987: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:33<00:00,  8.46s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00214 lr:0.0002 p_true:0.991 p_fake:0.991: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:35<00:00,  8.82s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00115 lr:0.0002 p_true:0.995 p_fake:0.995: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:33<00:00,  8.45s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00137 lr:0.0002 p_true:0.994 p_fake:0.995: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:34<00:00,  8.50s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.46589 lr:0.0002 p_true:0.731 p_fake:0.731: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:33<00:00,  8.29s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00245 lr:0.0002 p_true:0.989 p_fake:0.989: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:33<00:00,  8.30s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00092 lr:0.0002 p_true:0.995 p_fake:0.995: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:34<00:00,  8.55s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00073 lr:0.0002 p_true:0.996 p_fake:0.996: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:34<00:00,  8.64s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00051 lr:0.0002 p_true:0.997 p_fake:0.997: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:34<00:00,  8.53s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00041 lr:0.0002 p_true:0.998 p_fake:0.998: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:33<00:00,  8.33s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00052 lr:0.0002 p_true:0.997 p_fake:0.997: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:33<00:00,  8.49s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00073 lr:0.0002 p_true:0.996 p_fake:0.997: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:33<00:00,  8.47s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.13377 lr:0.0002 p_true:0.855 p_fake:0.864: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:33<00:00,  8.39s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00044 lr:0.0002 p_true:0.998 p_fake:0.998: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:34<00:00,  8.68s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00017 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:33<00:00,  8.35s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00016 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:33<00:00,  8.36s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00013 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:34<00:00,  8.72s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00036 lr:0.0002 p_true:0.998 p_fake:0.998: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:35<00:00,  8.80s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00037 lr:0.0002 p_true:0.998 p_fake:0.998: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:34<00:00,  8.68s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00059 lr:0.0002 p_true:0.997 p_fake:0.998: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:35<00:00,  8.76s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00843 lr:0.0002 p_true:0.979 p_fake:0.978: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:34<00:00,  8.66s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00014 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:34<00:00,  8.65s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00011 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:34<00:00,  8.66s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:7e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:34<00:00,  8.73s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:7e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:34<00:00,  8.69s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.0001 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:34<00:00,  8.71s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00011 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:34<00:00,  8.66s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.0005 lr:0.0002 p_true:0.998 p_fake:0.998: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:34<00:00,  8.69s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00026 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:34<00:00,  8.70s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:4e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:34<00:00,  8.62s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:6e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:34<00:00,  8.68s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:3e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:34<00:00,  8.68s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:8e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:34<00:00,  8.66s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00049 lr:0.0002 p_true:0.998 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:34<00:00,  8.52s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.0007 lr:0.0002 p_true:0.998 p_fake:0.997: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:34<00:00,  8.56s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:6e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:33<00:00,  8.45s/it]
INFO:__main__:instance_auroc: 0.984                                                                                                                                                                          
INFO:__main__:full_pixel_auroc: 0.985
INFO:__main__:anomaly_pixel_auroc: 0.942
INFO:__main__:

-----

INFO:__main__:Evaluating dataset [mvtec_capsule] (3/15)...
/home/kan/anaconda3/envs/fed38/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/kan/anaconda3/envs/fed38/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=Wide_ResNet50_2_Weights.IMAGENET1K_V1`. You can also use `weights=Wide_ResNet50_2_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
INFO:__main__:Training models (1/1)
INFO:simplenet:Training discriminator...
epoch:3 loss:0.1904 lr:0.0002 p_true:0.643 p_fake:0.664: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.90s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.05234 lr:0.0002 p_true:0.885 p_fake:0.892: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.88s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.02138 lr:0.0002 p_true:0.947 p_fake:0.95: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.92s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00903 lr:0.0002 p_true:0.972 p_fake:0.974: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.92s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.0062 lr:0.0002 p_true:0.981 p_fake:0.982: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.93s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00349 lr:0.0002 p_true:0.988 p_fake:0.988: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.92s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00351 lr:0.0002 p_true:0.989 p_fake:0.989: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.94s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00331 lr:0.0002 p_true:0.99 p_fake:0.99: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.91s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00229 lr:0.0002 p_true:0.993 p_fake:0.994: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.93s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.1033 lr:0.0002 p_true:0.874 p_fake:0.881: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.94s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00104 lr:0.0002 p_true:0.996 p_fake:0.997: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.97s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00063 lr:0.0002 p_true:0.998 p_fake:0.998: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.93s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00109 lr:0.0002 p_true:0.996 p_fake:0.997: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.94s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00066 lr:0.0002 p_true:0.998 p_fake:0.998: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.90s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00118 lr:0.0002 p_true:0.996 p_fake:0.997: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.10s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00822 lr:0.0002 p_true:0.984 p_fake:0.985: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.93s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00678 lr:0.0002 p_true:0.987 p_fake:0.987: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.96s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00284 lr:0.0002 p_true:0.994 p_fake:0.994: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.93s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00091 lr:0.0002 p_true:0.998 p_fake:0.998: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.95s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.03167 lr:0.0002 p_true:0.956 p_fake:0.96: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.94s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.0003 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.95s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:7e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.93s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:5e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.94s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:5e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.94s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00024 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.91s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.0007 lr:0.0002 p_true:0.998 p_fake:0.998: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.91s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.0097 lr:0.0002 p_true:0.987 p_fake:0.988: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.89s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00044 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.95s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.0001 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.90s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00042 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.91s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00531 lr:0.0002 p_true:0.99 p_fake:0.991: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.97s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00077 lr:0.0002 p_true:0.998 p_fake:0.998: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.93s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00731 lr:0.0002 p_true:0.986 p_fake:0.986: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.97s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:6e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.91s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:3e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.88s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:2e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.93s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:2e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.90s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:2e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.85s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:3e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.89s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:6e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.91s/it]
INFO:__main__:instance_auroc: 0.976                                                                                                                                                                          
INFO:__main__:full_pixel_auroc: 0.989
INFO:__main__:anomaly_pixel_auroc: 0.924
INFO:__main__:

-----

INFO:__main__:Evaluating dataset [mvtec_carpet] (4/15)...
/home/kan/anaconda3/envs/fed38/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/kan/anaconda3/envs/fed38/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=Wide_ResNet50_2_Weights.IMAGENET1K_V1`. You can also use `weights=Wide_ResNet50_2_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
INFO:__main__:Training models (1/1)
INFO:simplenet:Training discriminator...
epoch:3 loss:0.02592 lr:0.0002 p_true:0.918 p_fake:0.929: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:34<00:00,  8.69s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00221 lr:0.0002 p_true:0.989 p_fake:0.99: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:34<00:00,  8.63s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00072 lr:0.0002 p_true:0.996 p_fake:0.996: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:34<00:00,  8.65s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00046 lr:0.0002 p_true:0.997 p_fake:0.998: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:34<00:00,  8.67s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.0004 lr:0.0002 p_true:0.998 p_fake:0.998: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:34<00:00,  8.70s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00668 lr:0.0002 p_true:0.986 p_fake:0.986: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:34<00:00,  8.67s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:5e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:34<00:00,  8.74s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:7e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:34<00:00,  8.66s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:4e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:37<00:00,  9.39s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:4e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:37<00:00,  9.35s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00026 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:37<00:00,  9.29s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.0325 lr:0.0002 p_true:0.957 p_fake:0.962: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:36<00:00,  9.25s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00021 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:37<00:00,  9.41s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:1e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:37<00:00,  9.28s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:1e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:37<00:00,  9.28s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:1e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:37<00:00,  9.33s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:3e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:34<00:00,  8.62s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:9e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:37<00:00,  9.29s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:6e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:37<00:00,  9.31s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:1e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:36<00:00,  9.01s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:1e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:35<00:00,  8.91s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:2e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:36<00:00,  9.08s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:2e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:36<00:00,  9.23s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:4e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:37<00:00,  9.35s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.05762 lr:0.0002 p_true:0.942 p_fake:0.947: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:38<00:00,  9.54s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:2e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:38<00:00,  9.69s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:1e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:37<00:00,  9.25s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:1e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:37<00:00,  9.36s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.0 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:36<00:00,  9.21s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:1e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:35<00:00,  8.76s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:1e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:34<00:00,  8.61s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:2e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:34<00:00,  8.64s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00267 lr:0.0002 p_true:0.996 p_fake:0.997: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:34<00:00,  8.64s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:2e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:34<00:00,  8.67s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:1e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:34<00:00,  8.62s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:1e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:34<00:00,  8.64s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:1e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:34<00:00,  8.63s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:1e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:34<00:00,  8.60s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00099 lr:0.0002 p_true:0.998 p_fake:0.998: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:34<00:00,  8.66s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.0006 lr:0.0002 p_true:0.998 p_fake:0.999: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:35<00:00,  8.86s/it]
INFO:__main__:instance_auroc: 0.997                                                                                                                                                                          
INFO:__main__:full_pixel_auroc: 0.978
INFO:__main__:anomaly_pixel_auroc: 0.839
INFO:__main__:

-----

INFO:__main__:Evaluating dataset [mvtec_grid] (5/15)...
/home/kan/anaconda3/envs/fed38/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/kan/anaconda3/envs/fed38/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=Wide_ResNet50_2_Weights.IMAGENET1K_V1`. You can also use `weights=Wide_ResNet50_2_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
INFO:__main__:Training models (1/1)
INFO:simplenet:Training discriminator...
epoch:3 loss:0.95718 lr:0.0002 p_true:0.154 p_fake:0.168: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:34<00:00,  8.52s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.85265 lr:0.0002 p_true:0.219 p_fake:0.233: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:33<00:00,  8.45s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.71658 lr:0.0002 p_true:0.303 p_fake:0.324: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:33<00:00,  8.47s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.4972 lr:0.0002 p_true:0.433 p_fake:0.459: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:34<00:00,  8.68s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.3603 lr:0.0002 p_true:0.553 p_fake:0.572: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:34<00:00,  8.58s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.11331 lr:0.0002 p_true:0.786 p_fake:0.801: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:32<00:00,  8.13s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00511 lr:0.0002 p_true:0.978 p_fake:0.98: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:32<00:00,  8.14s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00232 lr:0.0002 p_true:0.988 p_fake:0.989: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:32<00:00,  8.14s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00141 lr:0.0002 p_true:0.992 p_fake:0.993: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:32<00:00,  8.16s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00101 lr:0.0002 p_true:0.994 p_fake:0.994: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:32<00:00,  8.14s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00077 lr:0.0002 p_true:0.995 p_fake:0.996: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:33<00:00,  8.40s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00064 lr:0.0002 p_true:0.996 p_fake:0.996: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:33<00:00,  8.34s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00049 lr:0.0002 p_true:0.997 p_fake:0.997: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:33<00:00,  8.34s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00038 lr:0.0002 p_true:0.998 p_fake:0.998: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:32<00:00,  8.20s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00059 lr:0.0002 p_true:0.996 p_fake:0.997: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:32<00:00,  8.16s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00096 lr:0.0002 p_true:0.995 p_fake:0.996: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:32<00:00,  8.20s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.84569 lr:0.0002 p_true:0.21 p_fake:0.214: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:32<00:00,  8.18s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.39897 lr:0.0002 p_true:0.557 p_fake:0.575: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:32<00:00,  8.18s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.26258 lr:0.0002 p_true:0.708 p_fake:0.72: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:32<00:00,  8.16s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00036 lr:0.0002 p_true:0.999 p_fake:0.998: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:32<00:00,  8.16s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00012 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:32<00:00,  8.16s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:7e-05 lr:0.0002 p_true:1.0 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:32<00:00,  8.16s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:8e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:32<00:00,  8.15s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:5e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:32<00:00,  8.14s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:5e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:32<00:00,  8.17s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:5e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:32<00:00,  8.14s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:3e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:32<00:00,  8.15s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:3e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:32<00:00,  8.14s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:2e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:32<00:00,  8.17s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:3e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:32<00:00,  8.16s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:2e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:33<00:00,  8.27s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:3e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:33<00:00,  8.32s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:5e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:34<00:00,  8.52s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00027 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:33<00:00,  8.28s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.84031 lr:0.0002 p_true:0.191 p_fake:0.191: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:33<00:00,  8.34s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.30173 lr:0.0002 p_true:0.615 p_fake:0.637: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:34<00:00,  8.66s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00027 lr:0.0002 p_true:0.999 p_fake:0.998: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:34<00:00,  8.54s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:8e-05 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:34<00:00,  8.55s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:5e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:34<00:00,  8.54s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:4e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:34<00:00,  8.54s/it]
INFO:__main__:instance_auroc: 0.991                                                                                                                                                                          
INFO:__main__:full_pixel_auroc: 0.988
INFO:__main__:anomaly_pixel_auroc: 0.953
INFO:__main__:

-----

INFO:__main__:Evaluating dataset [mvtec_tile] (6/15)...
/home/kan/anaconda3/envs/fed38/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/kan/anaconda3/envs/fed38/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=Wide_ResNet50_2_Weights.IMAGENET1K_V1`. You can also use `weights=Wide_ResNet50_2_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
INFO:__main__:Training models (1/1)
INFO:simplenet:Training discriminator...
epoch:3 loss:0.13195 lr:0.0002 p_true:0.717 p_fake:0.746: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:30<00:00,  7.53s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00681 lr:0.0002 p_true:0.972 p_fake:0.975: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:30<00:00,  7.51s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00215 lr:0.0002 p_true:0.99 p_fake:0.991: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:30<00:00,  7.53s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00087 lr:0.0002 p_true:0.996 p_fake:0.996: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:29<00:00,  7.46s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00176 lr:0.0002 p_true:0.993 p_fake:0.994: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:29<00:00,  7.46s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00888 lr:0.0002 p_true:0.979 p_fake:0.98: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:29<00:00,  7.45s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00131 lr:0.0002 p_true:0.996 p_fake:0.996: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.13s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00112 lr:0.0002 p_true:0.997 p_fake:0.998: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.12s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00737 lr:0.0002 p_true:0.985 p_fake:0.987: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.12s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00236 lr:0.0002 p_true:0.994 p_fake:0.995: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.10s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00403 lr:0.0002 p_true:0.991 p_fake:0.992: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.09s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00256 lr:0.0002 p_true:0.995 p_fake:0.996: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.12s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00258 lr:0.0002 p_true:0.994 p_fake:0.995: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.12s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00123 lr:0.0002 p_true:0.997 p_fake:0.997: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.14s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.01397 lr:0.0002 p_true:0.98 p_fake:0.982: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.10s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00152 lr:0.0002 p_true:0.997 p_fake:0.997: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.09s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00157 lr:0.0002 p_true:0.998 p_fake:0.998: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.11s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00196 lr:0.0002 p_true:0.997 p_fake:0.998: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.12s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00087 lr:0.0002 p_true:0.998 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.13s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00165 lr:0.0002 p_true:0.997 p_fake:0.998: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.11s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00156 lr:0.0002 p_true:0.997 p_fake:0.998: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.14s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00074 lr:0.0002 p_true:0.998 p_fake:0.998: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.10s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.0009 lr:0.0002 p_true:0.998 p_fake:0.999: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.12s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.0017 lr:0.0002 p_true:0.997 p_fake:0.998: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.15s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00174 lr:0.0002 p_true:0.998 p_fake:0.998: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.15s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00055 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.12s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00066 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.11s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00222 lr:0.0002 p_true:0.997 p_fake:0.998: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.10s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.0017 lr:0.0002 p_true:0.997 p_fake:0.998: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.13s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00328 lr:0.0002 p_true:0.997 p_fake:0.997: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.12s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00085 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.14s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.004 lr:0.0002 p_true:0.994 p_fake:0.995: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.10s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00261 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.14s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.0015 lr:0.0002 p_true:0.998 p_fake:0.998: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.14s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00121 lr:0.0002 p_true:0.998 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.12s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00101 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.10s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00623 lr:0.0002 p_true:0.991 p_fake:0.992: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.14s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00247 lr:0.0002 p_true:0.998 p_fake:0.998: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.11s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00279 lr:0.0002 p_true:0.998 p_fake:0.998: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:29<00:00,  7.28s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.0018 lr:0.0002 p_true:0.997 p_fake:0.998: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:29<00:00,  7.32s/it]
INFO:__main__:instance_auroc: 1.000                                                                                                                                                                          
INFO:__main__:full_pixel_auroc: 0.933
INFO:__main__:anomaly_pixel_auroc: 0.883
INFO:__main__:

-----

INFO:__main__:Evaluating dataset [mvtec_wood] (7/15)...
/home/kan/anaconda3/envs/fed38/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/kan/anaconda3/envs/fed38/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=Wide_ResNet50_2_Weights.IMAGENET1K_V1`. You can also use `weights=Wide_ResNet50_2_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
INFO:__main__:Training models (1/1)
INFO:simplenet:Training discriminator...
epoch:3 loss:0.17996 lr:0.0002 p_true:0.708 p_fake:0.74: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  7.98s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.01081 lr:0.0002 p_true:0.963 p_fake:0.968: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  7.99s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00326 lr:0.0002 p_true:0.986 p_fake:0.988: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  7.90s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00226 lr:0.0002 p_true:0.991 p_fake:0.992: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  7.93s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00145 lr:0.0002 p_true:0.994 p_fake:0.995: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  7.83s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00108 lr:0.0002 p_true:0.996 p_fake:0.997: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  7.90s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00126 lr:0.0002 p_true:0.996 p_fake:0.996: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  7.86s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.0008 lr:0.0002 p_true:0.998 p_fake:0.998: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  7.93s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00044 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  7.96s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.04147 lr:0.0002 p_true:0.94 p_fake:0.947: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  7.92s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00112 lr:0.0002 p_true:0.998 p_fake:0.998: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  7.94s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00135 lr:0.0002 p_true:0.998 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  7.94s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00354 lr:0.0002 p_true:0.992 p_fake:0.993: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  7.89s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.01691 lr:0.0002 p_true:0.973 p_fake:0.975: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  7.88s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00019 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  7.87s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:4e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  7.88s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.0 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  7.80s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:1e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  7.79s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:1e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  7.80s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00017 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  7.84s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00354 lr:0.0002 p_true:0.993 p_fake:0.994: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  7.92s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00104 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  7.91s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00861 lr:0.0002 p_true:0.989 p_fake:0.991: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  7.89s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00029 lr:0.0002 p_true:1.0 p_fake:0.999: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  7.85s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00165 lr:0.0002 p_true:0.997 p_fake:0.998: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  7.89s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00089 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  7.89s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00346 lr:0.0002 p_true:0.995 p_fake:0.996: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  7.87s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.02342 lr:0.0002 p_true:0.973 p_fake:0.975: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  7.89s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.0006 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  7.88s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00533 lr:0.0002 p_true:0.994 p_fake:0.995: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  7.91s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00119 lr:0.0002 p_true:0.998 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  7.89s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00482 lr:0.0002 p_true:0.994 p_fake:0.995: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  7.92s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.0016 lr:0.0002 p_true:0.998 p_fake:0.998: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  7.89s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00463 lr:0.0002 p_true:0.995 p_fake:0.996: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  7.91s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00077 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  7.91s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00169 lr:0.0002 p_true:0.998 p_fake:0.998: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  7.89s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00124 lr:0.0002 p_true:0.998 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  7.87s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.01255 lr:0.0002 p_true:0.986 p_fake:0.988: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  7.92s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00107 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  7.89s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00125 lr:0.0002 p_true:0.999 p_fake:0.998: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  7.88s/it]
INFO:__main__:instance_auroc: 0.999                                                                                                                                                                          
INFO:__main__:full_pixel_auroc: 0.924
INFO:__main__:anomaly_pixel_auroc: 0.811
INFO:__main__:

-----

INFO:__main__:Evaluating dataset [mvtec_zipper] (8/15)...
/home/kan/anaconda3/envs/fed38/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/kan/anaconda3/envs/fed38/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=Wide_ResNet50_2_Weights.IMAGENET1K_V1`. You can also use `weights=Wide_ResNet50_2_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
INFO:__main__:Training models (1/1)
INFO:simplenet:Training discriminator...
epoch:3 loss:0.17854 lr:0.0002 p_true:0.663 p_fake:0.686: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:30<00:00,  7.57s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.03379 lr:0.0002 p_true:0.908 p_fake:0.914: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:30<00:00,  7.52s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00693 lr:0.0002 p_true:0.973 p_fake:0.975: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:30<00:00,  7.54s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00397 lr:0.0002 p_true:0.983 p_fake:0.985: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:30<00:00,  7.51s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00151 lr:0.0002 p_true:0.992 p_fake:0.993: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:30<00:00,  7.55s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00083 lr:0.0002 p_true:0.995 p_fake:0.996: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:30<00:00,  7.52s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00101 lr:0.0002 p_true:0.995 p_fake:0.995: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:30<00:00,  7.52s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00067 lr:0.0002 p_true:0.996 p_fake:0.997: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:30<00:00,  7.51s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00049 lr:0.0002 p_true:0.997 p_fake:0.997: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:30<00:00,  7.54s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00036 lr:0.0002 p_true:0.998 p_fake:0.998: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:30<00:00,  7.53s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00045 lr:0.0002 p_true:0.998 p_fake:0.998: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:30<00:00,  7.53s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.0009 lr:0.0002 p_true:0.996 p_fake:0.997: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:30<00:00,  7.53s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00064 lr:0.0002 p_true:0.996 p_fake:0.996: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:30<00:00,  7.54s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.0003 lr:0.0002 p_true:0.998 p_fake:0.998: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:30<00:00,  7.53s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00016 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:30<00:00,  7.53s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00013 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:30<00:00,  7.53s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00013 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:30<00:00,  7.52s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00018 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:30<00:00,  7.51s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00012 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:30<00:00,  7.52s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00018 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:30<00:00,  7.52s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00015 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:30<00:00,  7.52s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.0001 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:30<00:00,  7.52s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00015 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:30<00:00,  7.53s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.0002 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:30<00:00,  7.53s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00058 lr:0.0002 p_true:0.997 p_fake:0.997: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:30<00:00,  7.55s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00011 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:30<00:00,  7.52s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:7e-05 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:30<00:00,  7.52s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:6e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:29<00:00,  7.50s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:5e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:30<00:00,  7.53s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:4e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:30<00:00,  7.52s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:4e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:30<00:00,  7.51s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:5e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:30<00:00,  7.53s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00037 lr:0.0002 p_true:0.998 p_fake:0.998: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:30<00:00,  7.54s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.0001 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:30<00:00,  7.53s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00019 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:30<00:00,  7.54s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00092 lr:0.0002 p_true:0.997 p_fake:0.997: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:30<00:00,  7.54s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:9e-05 lr:0.0002 p_true:1.0 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:30<00:00,  7.54s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:4e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:30<00:00,  7.52s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:2e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:30<00:00,  7.51s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:2e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:30<00:00,  7.51s/it]
INFO:__main__:instance_auroc: 0.999                                                                                                                                                                          
INFO:__main__:full_pixel_auroc: 0.988
INFO:__main__:anomaly_pixel_auroc: 0.951
INFO:__main__:

-----

INFO:__main__:Evaluating dataset [mvtec_cable] (9/15)...
/home/kan/anaconda3/envs/fed38/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/kan/anaconda3/envs/fed38/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=Wide_ResNet50_2_Weights.IMAGENET1K_V1`. You can also use `weights=Wide_ResNet50_2_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
INFO:__main__:Training models (1/1)
INFO:simplenet:Training discriminator...
epoch:3 loss:0.62064 lr:0.0002 p_true:0.264 p_fake:0.285: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.15s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.20906 lr:0.0002 p_true:0.629 p_fake:0.644: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.12s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.03938 lr:0.0002 p_true:0.898 p_fake:0.903: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.13s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.01139 lr:0.0002 p_true:0.964 p_fake:0.965: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.13s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00969 lr:0.0002 p_true:0.971 p_fake:0.972: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.13s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00361 lr:0.0002 p_true:0.988 p_fake:0.988: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.14s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00143 lr:0.0002 p_true:0.994 p_fake:0.994: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.12s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00445 lr:0.0002 p_true:0.986 p_fake:0.988: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.14s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.02642 lr:0.0002 p_true:0.947 p_fake:0.947: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.14s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00092 lr:0.0002 p_true:0.997 p_fake:0.997: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.15s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00043 lr:0.0002 p_true:0.998 p_fake:0.998: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.13s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.03915 lr:0.0002 p_true:0.931 p_fake:0.932: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.13s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00036 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.16s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00012 lr:0.0002 p_true:1.0 p_fake:0.999: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.12s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:9e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.12s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00019 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.10s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.01629 lr:0.0002 p_true:0.971 p_fake:0.974: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.14s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00308 lr:0.0002 p_true:0.993 p_fake:0.993: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.13s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00038 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.17s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00013 lr:0.0002 p_true:1.0 p_fake:0.999: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.13s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00013 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.11s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00011 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.12s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.25463 lr:0.0002 p_true:0.76 p_fake:0.767: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.13s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00049 lr:0.0002 p_true:0.999 p_fake:0.998: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.14s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00012 lr:0.0002 p_true:1.0 p_fake:0.999: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.15s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:7e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.11s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.0001 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.13s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00087 lr:0.0002 p_true:0.997 p_fake:0.998: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.12s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.13425 lr:0.0002 p_true:0.855 p_fake:0.86: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.12s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00131 lr:0.0002 p_true:0.997 p_fake:0.997: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.11s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00015 lr:0.0002 p_true:1.0 p_fake:0.999: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.15s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:6e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.10s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:5e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.14s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:8e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.13s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00016 lr:0.0002 p_true:0.999 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.12s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.12088 lr:0.0002 p_true:0.876 p_fake:0.881: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.10s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00118 lr:0.0002 p_true:0.998 p_fake:0.997: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.16s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00013 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.16s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:4e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.11s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:4e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:28<00:00,  7.08s/it]
INFO:__main__:instance_auroc: 0.999                                                                                                                                                                          
INFO:__main__:full_pixel_auroc: 0.971
INFO:__main__:anomaly_pixel_auroc: 0.888
INFO:__main__:

-----

INFO:__main__:Evaluating dataset [mvtec_toothbrush] (10/15)...
/home/kan/anaconda3/envs/fed38/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/kan/anaconda3/envs/fed38/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=Wide_ResNet50_2_Weights.IMAGENET1K_V1`. You can also use `weights=Wide_ResNet50_2_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
INFO:__main__:Training models (1/1)
INFO:simplenet:Training discriminator...
epoch:3 loss:0.75247 lr:0.0002 p_true:0.111 p_fake:0.105: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:08<00:00,  2.15s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.66384 lr:0.0002 p_true:0.328 p_fake:0.339: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:08<00:00,  2.15s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.42063 lr:0.0002 p_true:0.397 p_fake:0.413: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:08<00:00,  2.15s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.36485 lr:0.0002 p_true:0.509 p_fake:0.528: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:08<00:00,  2.16s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.20477 lr:0.0002 p_true:0.63 p_fake:0.659: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:08<00:00,  2.17s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.17783 lr:0.0002 p_true:0.692 p_fake:0.723: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:08<00:00,  2.15s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.20365 lr:0.0002 p_true:0.712 p_fake:0.713: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:08<00:00,  2.14s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.11894 lr:0.0002 p_true:0.787 p_fake:0.795: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:08<00:00,  2.17s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.09852 lr:0.0002 p_true:0.812 p_fake:0.828: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:08<00:00,  2.16s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.09181 lr:0.0002 p_true:0.838 p_fake:0.834: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:08<00:00,  2.15s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.05636 lr:0.0002 p_true:0.87 p_fake:0.875: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:08<00:00,  2.15s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.04972 lr:0.0002 p_true:0.887 p_fake:0.888: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:08<00:00,  2.16s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.05897 lr:0.0002 p_true:0.867 p_fake:0.891: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:08<00:00,  2.15s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.03672 lr:0.0002 p_true:0.909 p_fake:0.913: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:08<00:00,  2.15s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.0243 lr:0.0002 p_true:0.931 p_fake:0.933: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:08<00:00,  2.15s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.02022 lr:0.0002 p_true:0.942 p_fake:0.946: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:08<00:00,  2.16s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.03134 lr:0.0002 p_true:0.93 p_fake:0.925: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:08<00:00,  2.16s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.02212 lr:0.0002 p_true:0.944 p_fake:0.942: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:08<00:00,  2.15s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.01184 lr:0.0002 p_true:0.961 p_fake:0.963: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:08<00:00,  2.15s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00933 lr:0.0002 p_true:0.967 p_fake:0.969: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:08<00:00,  2.15s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.0065 lr:0.0002 p_true:0.975 p_fake:0.977: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:08<00:00,  2.14s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00624 lr:0.0002 p_true:0.977 p_fake:0.977: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:08<00:00,  2.16s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00373 lr:0.0002 p_true:0.984 p_fake:0.984: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:09<00:00,  2.31s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.01699 lr:0.0002 p_true:0.949 p_fake:0.961: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:08<00:00,  2.15s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.01659 lr:0.0002 p_true:0.956 p_fake:0.96: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:08<00:00,  2.15s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.01361 lr:0.0002 p_true:0.967 p_fake:0.964: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:08<00:00,  2.16s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.02582 lr:0.0002 p_true:0.936 p_fake:0.948: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:08<00:00,  2.16s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.03979 lr:0.0002 p_true:0.913 p_fake:0.941: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:08<00:00,  2.16s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.09685 lr:0.0002 p_true:0.862 p_fake:0.874: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:08<00:00,  2.17s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.01804 lr:0.0002 p_true:0.958 p_fake:0.955: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:08<00:00,  2.16s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00478 lr:0.0002 p_true:0.985 p_fake:0.984: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:08<00:00,  2.16s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00183 lr:0.0002 p_true:0.993 p_fake:0.991: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:08<00:00,  2.16s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00091 lr:0.0002 p_true:0.996 p_fake:0.995: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:08<00:00,  2.15s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00055 lr:0.0002 p_true:0.997 p_fake:0.997: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:08<00:00,  2.15s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00055 lr:0.0002 p_true:0.997 p_fake:0.997: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:08<00:00,  2.17s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00053 lr:0.0002 p_true:0.997 p_fake:0.997: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:08<00:00,  2.15s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.0004 lr:0.0002 p_true:0.998 p_fake:0.997: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:08<00:00,  2.16s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00036 lr:0.0002 p_true:0.998 p_fake:0.998: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:08<00:00,  2.16s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00032 lr:0.0002 p_true:0.998 p_fake:0.998: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:08<00:00,  2.14s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00041 lr:0.0002 p_true:0.997 p_fake:0.998: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:08<00:00,  2.15s/it]
INFO:__main__:instance_auroc: 1.000                                                                                                                                                                          
INFO:__main__:full_pixel_auroc: 0.985
INFO:__main__:anomaly_pixel_auroc: 0.931
INFO:__main__:

-----

INFO:__main__:Evaluating dataset [mvtec_transistor] (11/15)...
/home/kan/anaconda3/envs/fed38/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/kan/anaconda3/envs/fed38/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=Wide_ResNet50_2_Weights.IMAGENET1K_V1`. You can also use `weights=Wide_ResNet50_2_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
INFO:__main__:Training models (1/1)
INFO:simplenet:Training discriminator...
epoch:3 loss:0.45228 lr:0.0002 p_true:0.384 p_fake:0.411: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.87s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.11267 lr:0.0002 p_true:0.764 p_fake:0.776: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.84s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.03503 lr:0.0002 p_true:0.912 p_fake:0.916: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.84s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.01171 lr:0.0002 p_true:0.963 p_fake:0.965: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.82s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00528 lr:0.0002 p_true:0.981 p_fake:0.982: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.85s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.0038 lr:0.0002 p_true:0.986 p_fake:0.987: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.83s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00376 lr:0.0002 p_true:0.987 p_fake:0.988: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.84s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00241 lr:0.0002 p_true:0.991 p_fake:0.992: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.85s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00236 lr:0.0002 p_true:0.991 p_fake:0.992: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.82s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00636 lr:0.0002 p_true:0.982 p_fake:0.984: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.83s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00549 lr:0.0002 p_true:0.987 p_fake:0.987: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.86s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00044 lr:0.0002 p_true:0.998 p_fake:0.998: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.86s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00031 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.83s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00054 lr:0.0002 p_true:0.998 p_fake:0.998: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.80s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00112 lr:0.0002 p_true:0.996 p_fake:0.996: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.83s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00456 lr:0.0002 p_true:0.989 p_fake:0.99: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.83s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00086 lr:0.0002 p_true:0.997 p_fake:0.997: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.86s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00027 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.81s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00013 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.83s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:9e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.82s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00024 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.82s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00024 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.86s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00115 lr:0.0002 p_true:0.997 p_fake:0.997: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.86s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.04068 lr:0.0002 p_true:0.944 p_fake:0.946: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.83s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00021 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.84s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:7e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.82s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:8e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.84s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00011 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.82s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.0001 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.83s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.0445 lr:0.0002 p_true:0.938 p_fake:0.942: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.82s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00076 lr:0.0002 p_true:0.998 p_fake:0.998: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.86s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:7e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.80s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00016 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.84s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00011 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.84s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00018 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.83s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.21403 lr:0.0002 p_true:0.827 p_fake:0.834: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.83s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00014 lr:0.0002 p_true:1.0 p_fake:0.999: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.88s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:5e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.85s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:5e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.81s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:3e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.85s/it]
INFO:__main__:instance_auroc: 1.000                                                                                                                                                                          
INFO:__main__:full_pixel_auroc: 0.962
INFO:__main__:anomaly_pixel_auroc: 0.932
INFO:__main__:

-----

INFO:__main__:Evaluating dataset [mvtec_metal_nut] (12/15)...
/home/kan/anaconda3/envs/fed38/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/kan/anaconda3/envs/fed38/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=Wide_ResNet50_2_Weights.IMAGENET1K_V1`. You can also use `weights=Wide_ResNet50_2_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
INFO:__main__:Training models (1/1)
INFO:simplenet:Training discriminator...
epoch:3 loss:0.55472 lr:0.0002 p_true:0.31 p_fake:0.334: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.93s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.18642 lr:0.0002 p_true:0.662 p_fake:0.68: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.96s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.05012 lr:0.0002 p_true:0.877 p_fake:0.882: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.92s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.01336 lr:0.0002 p_true:0.957 p_fake:0.958: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.92s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00487 lr:0.0002 p_true:0.981 p_fake:0.982: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.94s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00309 lr:0.0002 p_true:0.987 p_fake:0.988: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.91s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00215 lr:0.0002 p_true:0.99 p_fake:0.991: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.94s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00215 lr:0.0002 p_true:0.991 p_fake:0.992: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.94s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00306 lr:0.0002 p_true:0.988 p_fake:0.989: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.92s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.29973 lr:0.0002 p_true:0.719 p_fake:0.729: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.91s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00139 lr:0.0002 p_true:0.994 p_fake:0.994: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.94s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00044 lr:0.0002 p_true:0.998 p_fake:0.998: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.92s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00033 lr:0.0002 p_true:0.998 p_fake:0.998: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.94s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00034 lr:0.0002 p_true:0.998 p_fake:0.998: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.92s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00042 lr:0.0002 p_true:0.998 p_fake:0.998: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.94s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.0005 lr:0.0002 p_true:0.998 p_fake:0.998: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.94s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00044 lr:0.0002 p_true:0.998 p_fake:0.998: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.95s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00225 lr:0.0002 p_true:0.992 p_fake:0.993: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.91s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.02643 lr:0.0002 p_true:0.945 p_fake:0.945: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.93s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00028 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.92s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00018 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.92s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00017 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.92s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00013 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.92s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00011 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.91s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00024 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.93s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00019 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.93s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00063 lr:0.0002 p_true:0.997 p_fake:0.998: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.93s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.01075 lr:0.0002 p_true:0.977 p_fake:0.977: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.95s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00011 lr:0.0002 p_true:1.0 p_fake:0.999: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.92s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:6e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.93s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:4e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.90s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:5e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.93s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:9e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.90s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00013 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.96s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00015 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.94s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00364 lr:0.0002 p_true:0.992 p_fake:0.993: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.94s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00091 lr:0.0002 p_true:0.997 p_fake:0.997: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.91s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:8e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.93s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:5e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.91s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:4e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:27<00:00,  6.90s/it]
INFO:__main__:instance_auroc: 1.000                                                                                                                                                                          
INFO:__main__:full_pixel_auroc: 0.984
INFO:__main__:anomaly_pixel_auroc: 0.873
INFO:__main__:

-----

INFO:__main__:Evaluating dataset [mvtec_bottle] (13/15)...
/home/kan/anaconda3/envs/fed38/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/kan/anaconda3/envs/fed38/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=Wide_ResNet50_2_Weights.IMAGENET1K_V1`. You can also use `weights=Wide_ResNet50_2_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
INFO:__main__:Training models (1/1)
INFO:simplenet:Training discriminator...
epoch:3 loss:0.38202 lr:0.0002 p_true:0.444 p_fake:0.466: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:26<00:00,  6.65s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.09437 lr:0.0002 p_true:0.801 p_fake:0.808: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:26<00:00,  6.70s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.03395 lr:0.0002 p_true:0.913 p_fake:0.917: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:26<00:00,  6.66s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.01423 lr:0.0002 p_true:0.957 p_fake:0.959: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:26<00:00,  6.66s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00626 lr:0.0002 p_true:0.978 p_fake:0.979: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:26<00:00,  6.67s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00406 lr:0.0002 p_true:0.985 p_fake:0.986: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:26<00:00,  6.63s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00306 lr:0.0002 p_true:0.988 p_fake:0.989: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:26<00:00,  6.65s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00764 lr:0.0002 p_true:0.978 p_fake:0.98: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:26<00:00,  6.65s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00247 lr:0.0002 p_true:0.991 p_fake:0.991: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:26<00:00,  6.66s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00188 lr:0.0002 p_true:0.993 p_fake:0.993: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:26<00:00,  6.66s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.5211 lr:0.0002 p_true:0.652 p_fake:0.657: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:26<00:00,  6.65s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00206 lr:0.0002 p_true:0.991 p_fake:0.991: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:26<00:00,  6.65s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00264 lr:0.0002 p_true:0.99 p_fake:0.992: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:26<00:00,  6.64s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00077 lr:0.0002 p_true:0.996 p_fake:0.996: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:26<00:00,  6.65s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00054 lr:0.0002 p_true:0.997 p_fake:0.997: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:26<00:00,  6.65s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.0007 lr:0.0002 p_true:0.996 p_fake:0.997: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:26<00:00,  6.65s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00066 lr:0.0002 p_true:0.997 p_fake:0.997: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:26<00:00,  6.65s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.04894 lr:0.0002 p_true:0.924 p_fake:0.932: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:26<00:00,  6.65s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00044 lr:0.0002 p_true:0.998 p_fake:0.998: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:26<00:00,  6.67s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00018 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:26<00:00,  6.66s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00016 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:26<00:00,  6.66s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00015 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:26<00:00,  6.66s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00017 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:26<00:00,  6.68s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00063 lr:0.0002 p_true:0.998 p_fake:0.998: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:26<00:00,  6.66s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.0022 lr:0.0002 p_true:0.994 p_fake:0.994: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:26<00:00,  6.67s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00058 lr:0.0002 p_true:0.998 p_fake:0.998: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:26<00:00,  6.66s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00127 lr:0.0002 p_true:0.997 p_fake:0.997: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:26<00:00,  6.66s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00023 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:26<00:00,  6.66s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00127 lr:0.0002 p_true:0.997 p_fake:0.998: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:26<00:00,  6.66s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00733 lr:0.0002 p_true:0.986 p_fake:0.987: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:26<00:00,  6.68s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00034 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:26<00:00,  6.65s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:6e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:26<00:00,  6.66s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:5e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:26<00:00,  6.64s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:6e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:26<00:00,  6.65s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00012 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:26<00:00,  6.65s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:9e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:26<00:00,  6.65s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00015 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:26<00:00,  6.67s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00024 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:26<00:00,  6.66s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.12557 lr:0.0002 p_true:0.873 p_fake:0.882: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:26<00:00,  6.67s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00012 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:26<00:00,  6.64s/it]
INFO:__main__:instance_auroc: 1.000                                                                                                                                                                          
INFO:__main__:full_pixel_auroc: 0.980
INFO:__main__:anomaly_pixel_auroc: 0.906
INFO:__main__:

-----

INFO:__main__:Evaluating dataset [mvtec_hazelnut] (14/15)...
/home/kan/anaconda3/envs/fed38/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/kan/anaconda3/envs/fed38/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=Wide_ResNet50_2_Weights.IMAGENET1K_V1`. You can also use `weights=Wide_ResNet50_2_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
INFO:__main__:Training models (1/1)
INFO:simplenet:Training discriminator...
epoch:3 loss:0.36224 lr:0.0002 p_true:0.539 p_fake:0.563: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:49<00:00, 12.28s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.11869 lr:0.0002 p_true:0.813 p_fake:0.824: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:49<00:00, 12.26s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.03545 lr:0.0002 p_true:0.928 p_fake:0.932: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:49<00:00, 12.29s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00841 lr:0.0002 p_true:0.977 p_fake:0.978: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:49<00:00, 12.27s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00672 lr:0.0002 p_true:0.981 p_fake:0.983: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:49<00:00, 12.28s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00132 lr:0.0002 p_true:0.995 p_fake:0.995: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:49<00:00, 12.26s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.18865 lr:0.0002 p_true:0.802 p_fake:0.811: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:49<00:00, 12.28s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00142 lr:0.0002 p_true:0.996 p_fake:0.996: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:49<00:00, 12.31s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00017 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:49<00:00, 12.27s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00011 lr:0.0002 p_true:1.0 p_fake:0.999: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:49<00:00, 12.26s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00023 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:49<00:00, 12.28s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.02204 lr:0.0002 p_true:0.962 p_fake:0.963: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:49<00:00, 12.29s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00031 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:49<00:00, 12.29s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:8e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:49<00:00, 12.27s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:7e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:49<00:00, 12.25s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.0001 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:48<00:00, 12.25s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.0011 lr:0.0002 p_true:0.997 p_fake:0.998: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:49<00:00, 12.31s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00239 lr:0.0002 p_true:0.995 p_fake:0.995: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:49<00:00, 12.29s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:7e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:49<00:00, 12.32s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:8e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:49<00:00, 12.25s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:9e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:49<00:00, 12.29s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:7e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:49<00:00, 12.26s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.0003 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:49<00:00, 12.29s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00437 lr:0.0002 p_true:0.992 p_fake:0.992: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:49<00:00, 12.31s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:9e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:49<00:00, 12.27s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:4e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:48<00:00, 12.25s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:2e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:49<00:00, 12.26s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:7e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:48<00:00, 12.21s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00102 lr:0.0002 p_true:0.998 p_fake:0.998: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:49<00:00, 12.30s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00064 lr:0.0002 p_true:0.998 p_fake:0.998: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:49<00:00, 12.28s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:4e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:49<00:00, 12.27s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:2e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:48<00:00, 12.19s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:4e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:48<00:00, 12.23s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:4e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:48<00:00, 12.18s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.05955 lr:0.0002 p_true:0.933 p_fake:0.935: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:49<00:00, 12.33s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:8e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:49<00:00, 12.29s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:4e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:48<00:00, 12.20s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:3e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:48<00:00, 12.19s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:7e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:48<00:00, 12.22s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.12834 lr:0.0002 p_true:0.883 p_fake:0.89: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:49<00:00, 12.26s/it]
INFO:__main__:instance_auroc: 0.999                                                                                                                                                                          
INFO:__main__:full_pixel_auroc: 0.981
INFO:__main__:anomaly_pixel_auroc: 0.852
INFO:__main__:

-----

INFO:__main__:Evaluating dataset [mvtec_leather] (15/15)...
/home/kan/anaconda3/envs/fed38/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/kan/anaconda3/envs/fed38/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=Wide_ResNet50_2_Weights.IMAGENET1K_V1`. You can also use `weights=Wide_ResNet50_2_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
INFO:__main__:Training models (1/1)
INFO:simplenet:Training discriminator...
epoch:3 loss:0.0339 lr:0.0002 p_true:0.895 p_fake:0.91: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  7.80s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00445 lr:0.0002 p_true:0.981 p_fake:0.983: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  7.80s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00119 lr:0.0002 p_true:0.993 p_fake:0.994: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  7.77s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00047 lr:0.0002 p_true:0.997 p_fake:0.997: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  7.82s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00032 lr:0.0002 p_true:0.998 p_fake:0.998: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  7.80s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00035 lr:0.0002 p_true:0.998 p_fake:0.998: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  7.80s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00019 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  7.80s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.0002 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  7.76s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00026 lr:0.0002 p_true:0.998 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  7.79s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.0002 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  7.79s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:2e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  7.78s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:3e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  7.76s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:3e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  7.81s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:3e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  7.75s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:5e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  7.80s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:4e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:30<00:00,  7.75s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00016 lr:0.0002 p_true:0.999 p_fake:0.999: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  7.80s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:6e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  7.76s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:2e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  7.76s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:1e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:30<00:00,  7.74s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:2e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:30<00:00,  7.74s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:1e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:30<00:00,  7.73s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:1e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:30<00:00,  7.75s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:2e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  7.75s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:3e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  7.76s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00011 lr:0.0002 p_true:0.999 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  7.76s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00011 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  7.77s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.00081 lr:0.0002 p_true:0.998 p_fake:0.998: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  7.79s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:1e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  7.77s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:1e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:30<00:00,  7.74s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.0 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:30<00:00,  7.74s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:1e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:30<00:00,  7.72s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:1e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:30<00:00,  7.74s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:4e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:30<00:00,  7.75s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:2e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  7.78s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.0462 lr:0.0002 p_true:0.953 p_fake:0.958: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  7.80s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:2e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:30<00:00,  7.74s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.0 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:30<00:00,  7.74s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:1e-05 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:30<00:00,  7.74s/it]
INFO:simplenet:Training discriminator...                                                                                                                                                                     
epoch:3 loss:0.0 lr:0.0002 p_true:1.0 p_fake:1.0: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:30<00:00,  7.74s/it]
INFO:__main__:instance_auroc: 1.000                                                                                                                                                                          
INFO:__main__:full_pixel_auroc: 0.991
INFO:__main__:anomaly_pixel_auroc: 0.964
INFO:__main__:

-----

INFO:utils:instance_auroc: 0.995
INFO:utils:full_pixel_auroc: 0.975
INFO:utils:anomaly_pixel_auroc: 0.907

